<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Boom Unit Test</title>
<link href="qunit-git.css"  type="text/css" rel="stylesheet" />
<script type="text/javascript" src="qunit-git.js"></script>
<script type="text/javascript" src="../dev/boom.js"></script>
</head>
<body>
<p>* Requires Http Server</p>
<h1 id="qunit-header">Boom Test</h1>
<h2 id="qunit-banner"></h2>
<div id="qunit-testrunner-toolbar"></div>
<h2 id="qunit-userAgent"></h2>
<ol id="qunit-tests"></ol>
<div id="qunit-fixture">test markup, will be hidden</div>

<script type="text/javascript">

asyncTest('add module', 3, function(){
	Boom.add('mod1', function(C){
		C.mod1=true
	});
	ok(Boom.Env.mods.hasOwnProperty('mod1'), 'add module success');
	
	Boom.use('mod1', function(){
		ok(true,'attache module callabck');
	});

	ok(Boom.mod1, 'use module success');
	start();
});


asyncTest('use module',1,function(C){
	Boom.add('test1',function(C){
		C.base=function(){
			
		}
	});
	Boom.add('extend',function(C){
		ok(typeof C.base =='function','require modlue success');
	},{requires:['test1']});

	Boom.use('extend');
	start();
});

asyncTest('add file',function(){
	var meta = Boom.Env.meta;
	Boom.add({
		'base':{path:'asset/base.js',mods:['util']},
		'mA_mB_mC':{path:'asset/mA_mB_mC.js',requires:['base'],mods:['mA','mB','mC']}
	});
	ok(meta.hasOwnProperty('base')&&
	meta.hasOwnProperty('mA_mB_mC'), 'add file success');

	start();
});

module('about file', {
	setup: function() {
		Boom.config('base', 'asset/');
		Boom.add({
			'base':{path:'base.js',mods:['util']},
			'mA_mB_mC':{path:'mA_mB_mC.js',requires:['base'],mods:['mA','mB','mC']},
			'mD.js':{path:'mD.js',requires:['base'],mods:['mD']},
			'mE.js':{path:'mE.js',requires:['base'],mods:['mE']},
			'needCss.js':{path:'needCss.js',requires:['a.css'],mods:['needCss']},
			'a.css':{path:'a.css'},
			'timeout.js':{path:'timeout.php'}
		});		
	}
})


asyncTest('use file',1,function(){
	Boom.use('mD.js',function(){
		ok(F_base&&F_mD,'use file success');
		start();
	});
});



asyncTest('use module by file',function(){
	Boom.use('mA',function(C){
		ok(typeof C.output == 'function'&&C.mA,'base.js loaded , mA attached');
		start();

	});	
});



asyncTest('use module that require css file',1,function(){

	Boom.use('needCss',function(){
		start();
		document.getElementsByTagName('body')[0].style.backgroundColor = 'white';
		ok(true,'needCss module used');
	});

});

asyncTest('load timeout',function(){
	Boom.config('fail',function(){
		ok(true,'timeout');
		start();
	});
	Boom.config({
		timeout:3000
	})
	Boom.load('timeout.js');
});

asyncTest('preload files parallelly then use module',2,function(){
	Boom.config({
		fail:function(){},
		timeout:6000
	});
	Boom.add('T1.js',{path:'asset/T1.php'});
	Boom.add('T2.js',{path:'asset/T2.php',requires:['T1.js'],mods:['T2']});
	Boom.use('T2.js',function(){
		ok(Boom.Env.mods['T2'],'T2.js loaded')
		Boom.use('T2',function(C){
			ok(C.result==10,'success');
			start();
		});
	});
});

asyncTest('load muti file',2,function(){
	var FILE_1,FILE_2;
	Boom.load('f1.js','f2.js');
});






</script>
</body>
</html>